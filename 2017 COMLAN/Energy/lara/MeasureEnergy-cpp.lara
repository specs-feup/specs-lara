aspectdef InstrumentCode
	
	
	select file end
	apply
		$file.addInclude("rapl.h", false);
		$file.addInclude("iostream", true);
	end
	
	var idCounter = 0;
	
	select function.call end
	apply
		var clava_energy_output = "clava_energy_output_"+(idCounter++);
	
		$call.insertBefore("rapl_monitor_start();");
		$call.insertAfter("std::cout << \"Energy:\" << "+clava_energy_output+";");
		$call.insertAfter("double "+clava_energy_output+" = rapl_monitor_report();");
	end
	
	
end
